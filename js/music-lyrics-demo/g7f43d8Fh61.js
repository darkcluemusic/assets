/* Compile by Suryo DwiJayanto */
function PreviewAudio(e,t){if(e.files&&e.files[0]&&$(t).length>0){$(t).stop();var a=new FileReader;a.onload=function(a){$(t).attr("src",a.target.result),a.target.files,e.files[0].name;var i=$(t).get(0).pause();void 0!==i&&i.then(e=>{$(t).show()}).catch(e=>{$(t).hide(),alert("File Is Not Valid Media File")})},a.readAsDataURL(e.files[0])}else $(t).attr("src",""),$(t).hide(),alert("File Not Selected")}window.onload=function(){var e=document.getElementsByClassName("audioPreview");for(let t of e)t.addEventListener("change",getFileName)};var dataImages,str1,str2,mreslt,getFileName=e=>{var t,a=e.target.files[0].name},inputImg=document.getElementById("imginput"),previewPhoto=()=>{var e=inputImg.files;if(e){var t=new FileReader,a=document.getElementById("mcover");t.onload=function(e){a.setAttribute("style","background-image: url("+e.target.result+") !important"),dataImages=e.target.result},t.readAsDataURL(e[0])}};inputImg.addEventListener("change",previewPhoto);var myoutputlink=document.getElementById("output").value;function mOutput(){str1=document.getElementById("artis").value,str2=document.getElementById("lagu").value,myoutputlink=mreslt=str1.replace(/ /g,"-").toLowerCase()+"-"+str2.replace(/ /g,"-").toLowerCase()}var _data="",currentLine="";function mDone(){var e=document.getElementById("artis").value,t=document.getElementById("album").value,a=document.getElementById("track").value,i=document.getElementById("genre").value,n=document.getElementById("lagu").value;if(e&&n&&document.getElementById("imginput").value&&t&&a&&i&&document.getElementById("stext").value&&document.getElementById("mamxa").value){if(document.getElementById("mupload").disabled=!0,document.getElementById("mupload").style.cursor="no-drop",document.getElementById("mupload").removeAttribute("onclick"),confirm("Apakah kamu ingin memasukkan data ini ke dalam database?")){var l=document.getElementById("mamxa").files[0],r="post/"+myoutputlink,s=firebase.storage().ref().child(r).child(l.name).put(l);s.on("state_changed",function(e){},function(e){},function(){s.snapshot.ref.getDownloadURL().then(function(e){document.getElementById("urlmusik").value=e,alert("Berhasil! lihat hasilnya di https://darkcluemusic.github.io/dcmplayer/"),saveMusic(e),window.open("https://darkcluemusic.github.io/dcmplayer/")})})}else fOoh()}else alert("Pastikan semua sudah terisi!")}function saveMusic(e){var t=document.getElementById("artis").value,a=document.getElementById("album").value,i=document.getElementById("track").value,n=document.getElementById("genre").value,l=document.getElementById("lagu").value,r=Number("0"),s=JSON.parse(document.getElementById("stext").value);firebase.database().ref("post/"+myoutputlink+"/").set({album:a,track:i,genre:n,view:r,artist:t,song:l,image:dataImages,music:e,uniq:myoutputlink,lc:s}),fOoh()}function fOoh(){_data=JSON.parse(document.getElementById("stext").value),document.getElementById("martis").innerHTML=document.getElementById("artis").value,document.getElementById("mlagu").innerHTML=document.getElementById("lagu").value,document.getElementById("main-inp").style.display="none",document.getElementById("main-music").style.display="flex",mounted()}function align(){var e=$(".highlighted").height(),t=$(".content").height(),a=$(".highlighted").offset().top-$(".highlighted").parent().offset().top;$(".content").animate({scrollTop:a+e/2-t/2+"px"},{easing:"swing",duration:250})}var lyricHeight=$(".lyrics").height();function generate(){for(var e="",t=0;t<_data.lyrics.length;t++)e+="<div",0==t&&(e+=' class="highlighted"',currentLine=0),_data.lyrics[t].note&&(e+=` note="${_data.lyrics[t].note}"`),e+=">",e+=""==_data.lyrics[t].line?"â€¢":_data.lyrics[t].line,e+="</div>";$(".lyrics").html(e),align()}async function mounted(){await generate()}$(window).on("resize",function(){$(".lyrics").height()!=lyricHeight&&(lyricHeight=$(".lyrics").height(),align())}),$(document).ready(function(){$("audio").on("timeupdate",function(e){var t=1e3*this.currentTime,a=_data.lyrics.filter(function(e){return e.time<t});_data.lyrics[a.length]!=currentLine&&(currentLine=_data.lyrics[a.length],$(".lyrics div").removeClass("highlighted"),$(`.lyrics div:nth-child(${a.length})`).addClass("highlighted"),align())})});
